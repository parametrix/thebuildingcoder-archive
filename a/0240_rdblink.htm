<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<link rel="stylesheet" type="text/css" href="bc.css">
</head>

<!-- 1253145 [Can we add custom columns in database while exporting data using RDBLink Utility] -->

<h3>Adding a Column to RDBLink</h3>

<p>Probably the most complex Revit SDK sample of all is the RDBLink one.
We mentioned it briefly in Anthony Hauck's note on

<a href="0187_db_integration_2.htm">
integration with a database or ERP system</a>,

but provided no additional details.
Like all the SDK samples, RDBLink comes with its own readme document, which is actually a lot more extensive than most others due to the size and complexity of this sample.
In brief, RDBLink demonstrates how to export Revit model data into an ODBC database and how to import data back from a database into Revit, possibly modifying or creating new Revit elements.
Here is a simple question on that topic, answered by my colleague Joe Ye:

<p><strong>Question:</strong> I am using RDBLink to export Revit data to a database.
I would like to add a few custom columns to the generated tables.
How can I do that?

<p>Also, when I dump the data, it overwrites all the previous data.
Can I append data to existing tables?

<p><strong>Answer:</strong> First the short answer to your second question:

<p>Unfortunately, RDBLink cannot append to existing tables.
It always synchronises the Revit document with the exported database.

<p>It is however possible to add custom columns to the exported database.
Which table do you want to add columns to?
Would you please tell me the table name?

<p><strong>Question:</strong> I would like to add a column "Facility Id" to the tables:

<ul>
<li>CurtainSystems
<li>DistributionSystems
<li>DuctSystems
<li>FurnitureSystems
<li>PipingSystems
<li>[dbo].[ElectricalEquipment]
</ul>

<p><strong>Answer:</strong> To add the columns you require, you can add shared parameters to the respective elements.
Then RDBLink will automatically generate new columns populated by the values of these shared parameters.
The readme file ReadMe_RDBLink.rtf provides more information on this:

<p style="color:darkblue">Create shared parameters: In the database editing form, user can add shared parameters to current document, and after
that new fields in the related tables for the elements will be created, user can give values to these new fields.
After importing, these new parameters will be updated.</p>

<p><strong>Question:</strong> I am quite new to this.
Can you please give me some more details?
Is there some other documentation available for it?

<p><strong>Answer:</strong> I just tested adding a shared parameter named 'test' to all doors in a project document and
then called the RDBLink external command to export the model data to an access database file.
The database contains a new column 'test' generated by this shared parameter, and populates it with the shared parameter values.
Here is the parameter that I added to the Revit BIM:</p>

<center>
<img src="img/rdblink_shared_param.png" alt="Shared parameter"/>
</center>

<p>Here is the exported data displayed in the database table:</p>

<center>
<img src="img/rdblink_db_column.png" alt="Database columns"/>
</center>

<p>The shared parameter can be created using the Revit user interface.
The command is described in the Revit product help file HelpArchitectureENU.chm in the Program subfolder, where you can find it through
Revit Architecture 2010 User's Guide &gt; Customizing Project Settings &gt; Custom Parameters.

<p>Thank you, Joe, for these answers!

<p>Shared parameters can also be created programmatically, and here are some pointers to previous posts on related topics:

<ul>

<li><a href="0036_dwg_shared_param.htm">
Adding a shared parameter to a DWG file</a>.</li>

<li><a href="0147_shared_param_rfa.htm">
Adding a shared parameter to a family</a>.</li>

<li><a href="0158_model_group_shared_param.htm">
Adding a shared parameter to almost any BIM element, including a model group</a>.</li>

<li><a href="0205_delete_shared_param.htm">
Deleting a shared parameter</a>.</li>

<li><a href="0208_shared_param_visibility.htm">
Shared parameter visibility</a>.</li>

</ul>

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
</body>
</html>
