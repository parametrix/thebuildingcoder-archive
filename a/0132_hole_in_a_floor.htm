<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<style>
.blue { color: blue; }
.teal { color: teal; }
.maroon { color: maroon; }
.green { color: green; }
</style>

<!-- 1249725 [Floors with openings] -->

<h3>Hole in a Floor</h3>

<p><strong>Question:</strong>
I am creating a floor using the Revit API method Document.NewFloor. It takes the arguments CurveArray, FloorType, Level, and Boolean. However, I would also like to create floors with openings in them, since this is quite normal for floors in real life &nbsp; ;-) &nbsp;
How can I do this via the API? The CurveArray parameter is apparently used to specify just one single simple loop.</p>

<p><strong>Answer:</strong>
The way to solve a problem like this, as always, is to search the Revit API documentation and samples.
Just like in the user interface, an opening in a floor is added after the floor has been constructed.
Looking through the RevitAPI.chm help file, I found that the Revit API provides an overloaded method named NewOpening on the creation document class for this purpose.
In 2010, a new method with the same name has also been added to the FamilyItemFactory class for defining openings in host elements such as walls or ceilings in family documents.
In your case, you are interested in the former.
Its various overloads do the following:</p>

<ul>
<li>Create a new opening in a beam, brace and column.</li>
<li>Create a new shaft opening between a set of levels.</li>
<li>Create a new opening in a roof, floor and ceiling.</li>
</ul>

<p>In other words, the third overload is exactly what you are looking for.</p>

<p>I then searched the Revit SDK samples globally for the NewOpening method and found occurrences in the NewOpenings and ShaftHolePuncher samples:</p>

<ul>
<li>The NewOpenings sample uses the Document.NewOpening method to create an opening on a selected wall or floor.</li>
<li>The ShaftHolePuncher sample demonstrates how to create a single or shaft opening on a wall, floor or beam.</li>
</ul>

<p>Hopefully, these samples will provide all the information you need to solve your task.</p>

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
</body>
</html>
