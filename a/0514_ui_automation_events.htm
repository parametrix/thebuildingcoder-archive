<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<link rel="stylesheet" type="text/css" href="bc.css">
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>

<!-- Rudolf Honke Re: Subscribing to UI Automation Events -->

<h3>Subscribing to UI Automation Events</h3>

<p>Rudolf Honke of

<a href="http://www.acadgraph.de">
acadGraph CADstudio GmbH</a> recently 

presented his results of exploring the Revit ribbon internals using UISpy and 

<a href="0507_ribbon_spy_automate.htm">
driving Revit using UI Automation</a>.

<p>He sent an additional note to point out that this rapidly leads to many other very interesting possibilities, such as the following:
 
<p><a href="http://msdn.microsoft.com/en-us/library/ms752286.aspx">
Subscribing to UI Automation events</a> could

easily enable an application to be notified whenever a user...

<ul> 
<li>Creates a new Wall, Room, etc.
<li>Picks into the property list
<li>Hits the ribbon bar
<li>Is about to open or save a Revit file (okay, this could possibly be achieved better in another way...)
<li>Resizes the Revit app window
<li>And so on ...
</ul>

<p>The events could be handled using a stand-alone application or a Revit add-in, registering the listener in the Revit external application OnStartup method...

<p>Thinking about using it with the OnStartup method, I remember the fact that some parts of the Revit UI may not be generated completely at this time.
In this method, you usually create your buttons, so the ribbon bar may be in rebuilding process.
Also, the ribbon bar could be invisible or disabled if there is no opened project file.
 
<p>Some time ago, I developed some functions to check the ribbon bar state before pressing any tab header or button.
One of these functions maximizes the ribbon bar if it is minimized.
 
<p>By the way, if you just want to be notified if the app window is resized or moved, you could also use a BackgroundWorker which checks the Window.Size ten times a second.
Using old (but fast) Windows API methods via P/Invoke, this "polling" can be done with up to 50 Hz or more &ndash; ups, another theme for posting...
 
<p>Hey, you could combine the notifyMeIfRoomIsToBeCreated listener with an OnDocumentOpened event, so the 'Create Room' button must be accessible (but you would have to check whether it is a family document)...

<p>Anyway, just think of the possibilities this can offer!

<p>A number of these features have actually been requested in the past, and nobody provided the UI Automation expertise to answer them ... until now.

<p>Once again, many thanks to Rudolf for his many ideas and these valuable pointers!

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
</body>
</html>
