<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<link rel="stylesheet" type="text/css" href="bc.css">
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>

<!-- Matt Mason Re: Interesting new behavior in 2013 -->

<h3>Edit Family Requires No Transaction</h3>

<p>I recently received a note from Matt Mason pointing out that the behaviour of the EditFamily method changed in Revit 2013, and a suggestion to highlight this fact.
The suggestion is very valid, since his note was quickly followed up by a matching 

<a href="0597_reload_family.htm">
question</a> by 

<a href="mailto:noclew@mit.edu">
Woong Ki Sung</a> on

<a href="0597_reload_family.htm">
reloading a family</a>, 

who ran into the very same issue:

<p><strong>Question:</strong> I am testing some code to edit family types in Revit 2013, and I have a transaction problem even though I set up manual transactions properly. 

<p><a href="http://dl.dropbox.com/u/39185526/familyEdit.cs">The code</a> is 

very simple, so could you please check? In advance, thank for your help.

<p>Here is the answer by Matt:

<p><strong>Answer:</strong> A quick note after I saw your recent post on upgrading add-ins.

<p>I had an interesting case the other day:
there is a new API requirement in 2013 that all transactions must be closed before calling EditFamily 
&ndash; it throws an exception to that effect.

<p>I hadn't really focused on this before, and the add-in in question was actually still set up for Automatic mode 
&ndash; I had to convert my add-in to manual transaction mode so that I could control the transactions and close them all prior to calling EditFamily.

<p>The remarks on the EditFamily method in the Revit 2013 API help file RevitAPI.chm now clearly state:

<p style="color:darkblue">Gets the document of a loaded family to edit. This creates an independent copy of the family for editing. To apply the changes back to the family stored in the document, use the LoadFamily overload accepting IFamilyLoadOptions. 

<p style="color:darkblue">This method may not be called if the document is currently modifiable (has an open transaction) or is in a read-only state. The method may not be called during dynamic updates. To test the document's current status, check the values of IsModifiable and IsReadOnly properties.

<p>Many thanks to Matt for pointing this out!

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
<script src="toc/copy-code.js"></script>
</body>
</html>
