<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>

<!--

Phil Xia Re: WorksetId case 08023175

-->

<h3>Change Element Workset</h3>

<p>We discussed

<a href="0678_workset_api.htm">
reading the workset of an element</a>,

either using the built-in parameter ELEM_PARTITION_PARAM or, more easily, the dedicated document GetWorksetId method.

<p>This is actually another example of the possibility to choose your data access method by using either a dedicated property or a parameter, as we recently explored to achieve

<a href="0885_viewport_type.htm">
changing the viewport type</a>.

<p>Although the Revit API provides a dedicated property to read an element workset, it does not do so for changing it, which begs the question:


<p><strong>Question:</strong> The Element.WorksetId property is read-only.

<p>I would like to change an element's workset to other one, though.

<p>Is this possible?


<p><strong>Answer:</strong> You can change the element's workset via the built-in parameter ELEM_PARTITION_PARAM.

<p>Here is a code snippet to show how to retrieve all workset ids and set each one to a given element in turn:

<pre class="code">
&nbsp; <span class="teal">Reference</span> r = uidoc.Selection.PickObject( <span class="teal">ObjectType</span>.Element );
&nbsp; <span class="teal">Element</span> e = doc.GetElement( r.ElementId );
&nbsp;
&nbsp; <span class="blue">if</span>( e == <span class="blue">null</span> )
&nbsp; &nbsp; <span class="blue">return</span>;
&nbsp;
&nbsp; <span class="teal">WorksetId</span> wid = e.WorksetId;
&nbsp;
&nbsp; <span class="teal">TaskDialog</span>.Show( <span class="maroon">&quot;Workset id&quot;</span>, wid.ToString() );
&nbsp;
&nbsp; <span class="teal">Parameter</span> wsparam = e.get_Parameter(
&nbsp; &nbsp; <span class="teal">BuiltInParameter</span>.ELEM_PARTITION_PARAM );
&nbsp;
&nbsp; <span class="blue">if</span>( wsparam == <span class="blue">null</span> )
&nbsp; &nbsp; <span class="blue">return</span>;
&nbsp;
&nbsp; <span class="green">// Find all user worksets </span>
&nbsp;
&nbsp; <span class="teal">FilteredWorksetCollector</span> worksets
&nbsp; &nbsp; = <span class="blue">new</span> <span class="teal">FilteredWorksetCollector</span>( doc )
&nbsp; &nbsp; &nbsp; .OfKind( <span class="teal">WorksetKind</span>.UserWorkset );
&nbsp;
&nbsp; <span class="blue">using</span>( <span class="teal">Transaction</span> tx = <span class="blue">new</span> <span class="teal">Transaction</span>( doc ) )
&nbsp; {
&nbsp; &nbsp; tx.Start( <span class="maroon">&quot;Change workset id&quot;</span> );
&nbsp;
&nbsp; &nbsp; <span class="blue">foreach</span>( <span class="teal">Workset</span> ws <span class="blue">in</span> worksets )
&nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; wsparam.Set( ws.Id.IntegerValue );
&nbsp; &nbsp; }
&nbsp;
&nbsp; &nbsp; tx.Commit();
&nbsp; }
&nbsp; wid = e.WorksetId;
&nbsp;
&nbsp; <span class="teal">TaskDialog</span>.Show( <span class="maroon">&quot;worksetid&quot;</span>, wid.ToString() );
</pre>

<p>Many thanks to Phil Xia for this hint!</p>



    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
<script src="toc/copy-code.js"></script>
</body>
</html>
