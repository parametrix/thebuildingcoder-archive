<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
</head>

<!--

08749742 [How to save GeometryObject to a file?]

Qiuming ChenSuzhou Bimcloud Software Technology

-->

<h3>How to Save a Solid to a File</h3>

<p>As I announced, I am

<a href="1022_preview_control_zoom.htm#5">
currently on vacation</a>.</p>

<p>Still, I don't want to leave you or The Building Coder completely abandoned for too long, so here is a quick question recently answered by my colleague

<a href="http://adndevblog.typepad.com/technology_perspective/akira-kudo.html">
Akira Kudo</a>:


<p><strong>Question:</strong> How can I save a solid to a file, please?</p>

<p>I searched for an applicable API call, but without success.</p>

<p>I am not trying to save a Revit element, or I could use the existing Export methods.</p>

<p>My object is an Autodesk.Revit.DB.Solid instance generated by the Autodesk.Revit.DB.BooleanOperationsUtils class.</p>

<p><strong>Answer:</strong> You could use the following workaround:

<ul>
<li>Create a new family with the given solid. </li>
<li>Export a 3D view of the family to a SAT file.</li>
<!-- using the method Export(string, string, ICollection&lt;ElementId&gt;, SATExportOptions) -->
</ul>

<p>Here are pointers to different Revit SDK samples demonstrating all the various steps:</p>

<p>To create family document, you can call the Application.NewFamilyDocument Method.</p>

<pre>
FreeFormElement/CS/FreeFormElementUtils.cs(66):

  Document familyDoc = app.NewFamilyDocument(
    familyTemplate);
</pre>

<p>To create a component in the family from the given solid, you can call the FreeFormElement.Create method.</p>

<pre>
FreeFormElement/CS/FreeFormElementUtils.cs(113):

  RevitFreeFormElement element = Autodesk.Revit.DB
    .FreeFormElement.Create(familyDoc, block);
</pre>

<p>To create a 3D view, you can call the View3D.CreateIsometric method:</p>

<pre>
GeometryAPI/SlaveSymbolGeometry/CS/SlaveSymbolGeometry.cs(82):

  View3D instanceView = View3D.CreateIsometric(
    RevitDoc, View3DId);
</pre>

<p>Finally, you can use the Document.Export method to export a collection of views to a SAT file:</p>

<pre>
ImportExport/CS/Export/ExportSATData.cs(164):

  exported = m_activeDoc.Export(m_exportFolder,
    m_exportFileName, viewIds, satExportOptions);
</pre>

<p>Revit can only export specified views, not an individual solid.
If the freeform element generated from the solid is the only element in the family, exporting the family 3D view has the same effect.</p>

<p>I hope you find this useful, and also enjoy this use of the Revit SDK samples to explore the application of the API methods in a fitting context for a specified real-world task.</p>

<p>Many thanks to Akira for providing this solution and illustrating this powerful approach.</p>

<p>And now, I return to my vacation pleasures...  :-)</p>

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
</body>
</html>
