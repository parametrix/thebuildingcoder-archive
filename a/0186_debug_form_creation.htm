<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<style>

pre { 
  font-size : 95%; 
  line-height : 120%; 
  background-color : lightgrey;
  white-space : wrap;
  color: darkblue;
  background-color : linen;
}

pre.code { 
  color: black;
  background-color : white; 
}

.blue { color: blue; }
.teal { color: teal; }
.maroon { color: maroon; }
.green { color: green; }
.gray { color: gray; }

</style>

<!-- 

-->

<h3>Debug Geometric Form Creation</h3>

<p>Here is a useful hint on debugging the generation of geometric shapes from Harry Mattison.</p>

<p><strong>Question:</strong>
I am trying to create multiple swept blends in a family document.
The first call to FamilyCreate.NewSweptBlendForm() succeeds, but the second call is failing with the following exception:</p>

<center>
<img src="img/swept_blend_creation_error.png" alt="Swept blend creation error"/>
</center>

<p><strong>Answer:</strong>
For problems like this I suggest commenting out the code that creates the form so that the command creates only the lines being used to create the form. 
Then you can run the command, verify the geometry of the lines, and use the Revit UI to select them and push the Create Form button. 
If Create Form fails, then the bug probably has nothing to do with the API.</p>

<p>In this case, there are many overlapping line warnings:</p>

<center>
<img src="img/swept_blend_creation_warnings.png" alt="Swept blend creation warnings"/>
</center>

<p>I'd expect that you will get better results if the geometry forms closed loops without overlaps.</p>

<p>Finally, this will be easier to debug if the lines are created in the active document instead of a new document created in the external command that is not visible without saving and reopening the file. 
Thin Lines mode might also be helpful because the lines are quite short.</p>

<p>Thank you very much Harry for these valuable suggestions!</p>

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
<script src="toc/copy-code.js"></script>
</body>
</html>
