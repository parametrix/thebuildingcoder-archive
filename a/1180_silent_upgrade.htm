<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Building Coder</title>
    <link rel="stylesheet" href="bc.css">
    <link rel="stylesheet" href="google-code-prettify/prettify.css">
    <script src="google-code-prettify/run_prettify.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        a { color: #0066cc; }
        img { max-width: 100%; height: auto; }
        .nav { margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        .nav a { margin-right: 15px; }
    </style>
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>
<body>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
    <article>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
  <link rel="stylesheet" href="toc/toc-sidebar.css">
</head>

<!--

09784259 [Upgrading family files silently]

Nagulan SelvakannuConfigura Pacific Sdn Bhd

-->


<h3>Upgrading Family Files Silently</h3>

<p>Here is a recent case that I like and can share with you just as it is:</p>

<p><strong>Question:</strong> My add-in loads a number of predefined families into the current document.
However, if many of them were saved in a previous version of Revit, a popup message saying the family file is being upgraded is displayed for each one.</p>

<p>Is there a way to load the families silently, so that the upgrade is still performed but the prompt is either not shown, or only shown once for the whole batch of family files?</p>

<p>Alternatively, if that is not possible, is there a way to find out if a model requires upgrading before loading it?</p>


<p><strong>Answer:</strong> Thank you for your very pertinent query.
I like it very much that you care about that  :-)</p>

<p>I can think of two completely different approaches.</p>

<p><strong>1.</strong> Google for

<a href="http://lmgtfy.com/?q=revit+file+updater">
revit file updater</a>.</p>

<p>Numerous results are available.</p>

<p>The

<a href="http://labs.blogs.com/its_alive_in_the_lab/2011/07/updated-file-upgrader-for-revit-now-available.html">
file upgrader on Autodesk labs</a> was

written by us, the ADN DevTech team, and is provided with full source code included as a learning tool.</p>

<p><strong>2.</strong> Handle the pop-up messages, so that the user never sees them, using one of the techniques suggested for

<span class="unavailable-link">handling dialogues and failures</span>.</p>

<p><strong>3.</strong>  Yes, you can

<a href="0887_rvt_file_version.htm">
determine the Revit version</a> used

to save a model.</p>

<p>The post describes two different approaches:
you can either use the documented and supported Revit API functionality provided by the BasicFileInfo class, or the unsupported approach parsing the RVT file yourself and extracting the desired information from its OLE document Structured Storage data.</p>


<p><strong>Addendum:</strong> Please don't miss the

<a href="1183_silent_upgrade.htm">
continuation of this discussion</a>.</p>

    </article>
    <div class="nav">
        <a href="index.html">← Back to Index</a>
    </div>
<script src="toc/toc-sidebar.js"></script>
<script src="toc/copy-code.js"></script>
</body>
</html>
